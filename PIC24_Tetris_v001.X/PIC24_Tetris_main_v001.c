/*
 * File:   PIC24_Tetris_main_v001.c
 * Author(s): Jacob Sprafka
 *
 * Created on October 23, 2020, 7:08 PM
 */

// CW1: FLASH CONFIGURATION WORD 1 (see PIC24 Family Reference Manual 24.1)
#pragma config ICS = PGx1          // Comm Channel Select
#pragma config FWDTEN = OFF        // Watchdog Timer is disabled
#pragma config GWRP = OFF          // Writes to program memory are allowed
#pragma config GCP = OFF           // Code protection is disabled
#pragma config JTAGEN = OFF        // JTAG port is disabled


// CW2: FLASH CONFIGURATION WORD 2 (see PIC24 Family Reference Manual 24.1)
#pragma config I2C1SEL = PRI       // Use default SCL1/SDA1 pins
#pragma config IOL1WAY = OFF       // IOLOCK may be changed via unlocking seq
#pragma config OSCIOFNC = ON       // CLKO/RC15 functions as I/O pin
#pragma config FCKSM = CSECME      // Clock switching is enabled, Fail-Safe Clock Monitor is enabled
#pragma config FNOSC = FRCPLL      // Fast RC Oscillator with PLL module (FRCPLL)

#include "xc.h"
#include "PIC24_setup.h"
#include "LCD_setup.h"
#include "sprite.h"
#include <stdlib.h>
#include <stdio.h>

/*
 ***********************************************
 * Pixel Data for Game Pieces                  *
 ***********************************************
 */


unsigned char longPiece[4][128] = {
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    }
};

unsigned char L1Piece[4][128] = {
    {
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    }
};

unsigned char L2Piece[4][128] = {
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    }
};

unsigned char squarePiece[4][128] = {
    {
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    }
};

unsigned char tPiece[4][128] = {
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    }
};

unsigned char sPiece[4][128] = {
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    }
};

unsigned char zPiece[4][128] = {
    {
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P3, Col 0-15
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    },
    {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P1, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P1, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, //P2, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P2, Col 16-32

        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P3, Col 16-32

        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 0-15
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, //P4, Col 16-32
    }
};

/**
 * *********************************************
 * Pixel Data for Score                        *
 * *********************************************
 */

unsigned char pixel0[8] = {0x3c, 0x66, 0x66, 0x66, 0x66, 0x66, 0x3c, 0x00};

unsigned char pixel1[8] = {0x18, 0x38, 0x78, 0x18, 0x18, 0x18, 0x18, 0x00};

unsigned char pixel2[8] = {0x3c, 0x66, 0x06, 0x0c, 0x18, 0x30, 0x7e, 0x00};

unsigned char pixel3[8] = {0x3c, 0x66, 0x06, 0x1c, 0x06, 0x66, 0x3c, 0x00};

unsigned char pixel4[8] = {0x1c, 0x3c, 0x6c, 0xcc, 0xfe, 0x0c, 0x0c, 0x00};

unsigned char pixel5[8] = {0x7E, 0x06, 0x7C, 0x06, 0x06, 0x66, 0x3C, 0x00};

unsigned char pixel6[8] = {0x1C, 0x30, 0x60, 0x7C, 0x66, 0x66, 0x3C, 0x00};

unsigned char pixel7[8] = {0x7E, 0x06, 0x06, 0x0C, 0x18, 0x18, 0x18, 0x00};

unsigned char pixel8[8] = {0x3C, 0x66, 0x66, 0x3C, 0x66, 0x66, 0x3C, 0x00};

unsigned char pixel9[8] = {0x3C, 0x66, 0x66, 0x3E, 0x06, 0x0C, 0x38, 0x00};

//Deprecated
/**
 * NAME: titleAnimation
 * PARAMETERS: sprite playPiece -
 *  unsigned char screen[1024] - array with pixel data that is to be displayed 
 *  on the screen
 *  unsigned char pField[1024] - array with pixel data that is used to update 
 *  the array 'screen
 * PURPOSE: this is a test function to see each of the pieces in every rotation 
 *  orientation. It is in a for loop, so it will choose one piece, display it in
 *  all 4 rotations, then move to the next piece
 * RETURNS: never returns
 */

void titleAnimation(sprite playPiece, unsigned char screen[1024], unsigned char pField[1024]) {
    int x;
    while (1) {
        switch (x) {
            case 0:
                playPiece.image = longPiece[playPiece.rotation];
                break;
            case 1:
                playPiece.image = L1Piece[playPiece.rotation];
                break;
            case 2:
                playPiece.image = sPiece[playPiece.rotation];
                break;
            case 3:
                playPiece.image = squarePiece[playPiece.rotation];
                break;
            case 4:
                playPiece.image = L2Piece[playPiece.rotation];
                break;
            case 5:
                playPiece.image = tPiece[playPiece.rotation];
                break;
            case 6:
                playPiece.image = zPiece[playPiece.rotation];
                break;
        }

        if (playPiece.rotation == 3) {
            playPiece.rotation = 0;
            x += x == 6 ? -6 : 1;

        } else {
            playPiece.rotation++;
        }

        drawField(pField, screen);
        drawSprite(playPiece, screen);
        drawScreenBuf(screen);
    }
}

/**
 * NAME: writeScore
 * PARAMETERS: int score - score at the end of the game
 *  unsigned char screen[1024] - array with pixel data that is to be displayed 
 *  on the screen
 *  unsigned char pField[1024] - array with pixel data that is used to update 
 *  the array 'screen'
 * PURPOSE: This will take the score at the end of the game and write it as a string.
 *  Then it will take each character in that string (all integers), and write 
 *  them onto the screen
 * RETURNS: n/a
 */

void writeScore(int score, unsigned char screen[1024], unsigned char pField[1024]) {

    initScreenBuf(pField);

    char str[4];
    int xPos = 80;
    int yPos = 5;

    sprintf(str, "%d", score);

    int i, j;
    for (i = 0; i < 4; i++) {
        switch (str[i]) {
            case '0':
                for (j = 0; j < 8; j++) {
                    pField[yPos * 128 + j + xPos] = pixel0[j];
                }

                yPos--;
                break;
            case '1':
                for (j = 0; j < 8; j++) {
                    pField[yPos * 128 + j + xPos] = pixel1[j];
                }
                yPos--;
                break;
            case '2':
                for (j = 0; j < 8; j++) {
                    pField[yPos * 128 + j + xPos] = pixel2[j];
                }
                yPos--;
                break;
            case '3':
                for (j = 0; j < 8; j++) {
                    pField[yPos * 128 + j + xPos] = pixel3[j];
                }
                yPos--;
                break;
            case '4':
                for (j = 0; j < 8; j++) {
                    pField[yPos * 128 + j + xPos] = pixel4[j];
                }
                yPos--;
                break;
            case '5':
                for (j = 0; j < 8; j++) {
                    pField[yPos * 128 + j + xPos] = pixel5[j];
                }
                yPos--;
                break;
            case '6':
                for (j = 0; j < 8; j++) {
                    pField[yPos * 128 + j + xPos] = pixel6[j];
                }
                yPos--;
                break;
            case '7':
                for (j = 0; j < 8; j++) {
                    pField[yPos * 128 + j + xPos] = pixel7[j];
                }
                yPos--;
                break;
            case '8':
                for (j = 0; j < 8; j++) {
                    pField[yPos * 128 + j + xPos] = pixel8[j];
                }
                yPos--;
                break;
            case '9':
                for (j = 0; j < 8; j++) {
                    pField[yPos * 128 + j + xPos] = pixel9[j];
                }
                yPos--;
                break;

        }

    }

    pField[55] = 0x00;
    pField[56] = 0x00;
    pField[57] = 0x00;
    pField[58] = 0x00;
    pField[59] = 0x00;
    pField[60] = 0x00;
    pField[61] = 0x00;
    pField[62] = 0x00;

    pField[183] = 0x80;
    pField[184] = 0x98;
    pField[185] = 0x18;
    pField[186] = 0x00;
    pField[187] = 0x00;
    pField[188] = 0x18;
    pField[189] = 0x98;
    pField[190] = 0x80;

    pField[311] = 0x1F;
    pField[312] = 0x9F;
    pField[313] = 0x90;
    pField[314] = 0x9C;
    pField[315] = 0x1C;
    pField[316] = 0x10;
    pField[317] = 0x9F;
    pField[318] = 0x9F;

    pField[439] = 0x1F;
    pField[440] = 0x9F;
    pField[441] = 0x98;
    pField[442] = 0x9F;
    pField[443] = 0x9F;
    pField[444] = 0x9E;
    pField[445] = 0x9B;
    pField[446] = 0x19;

    pField[567] = 0x1F;
    pField[568] = 0x3F;
    pField[569] = 0x3B;
    pField[570] = 0x3B;
    pField[571] = 0x3B;
    pField[572] = 0x3B;
    pField[573] = 0x3F;
    pField[574] = 0x1F;

    pField[695] = 0x1F;
    pField[696] = 0x3F;
    pField[697] = 0x30;
    pField[698] = 0x30;
    pField[699] = 0x30;
    pField[700] = 0x30;
    pField[701] = 0x3F;
    pField[702] = 0x1F;

    pField[823] = 0x1F;
    pField[824] = 0x3F;
    pField[825] = 0x20;
    pField[826] = 0x3E;
    pField[827] = 0x1F;
    pField[828] = 0x01;
    pField[829] = 0x3F;
    pField[830] = 0x3E;

    //game
    pField[141] = 0x80;
    pField[142] = 0x80;
    pField[143] = 0x00;
    pField[144] = 0x00;
    pField[145] = 0x00;
    pField[146] = 0x00;
    pField[147] = 0x00;
    pField[148] = 0xC0;
    pField[149] = 0xC0;

    pField[269] = 0x9F;
    pField[270] = 0x9F;
    pField[271] = 0x98;
    pField[272] = 0x98;
    pField[273] = 0x9E;
    pField[274] = 0x9E;
    pField[275] = 0x98;
    pField[276] = 0x9F;
    pField[277] = 0x9F;

    pField[397] = 0x61;
    pField[398] = 0x61;
    pField[399] = 0x73;
    pField[400] = 0x7F;
    pField[401] = 0x6D;
    pField[402] = 0x61;
    pField[403] = 0x61;
    pField[404] = 0x61;
    pField[405] = 0x61;

    pField[525] = 0x70;
    pField[526] = 0x70;
    pField[527] = 0x50;
    pField[528] = 0xD8;
    pField[529] = 0xF8;
    pField[530] = 0xFC;
    pField[531] = 0x8C;
    pField[532] = 0x8E;
    pField[533] = 0x06;

    pField[653] = 0xF0;
    pField[654] = 0xF8;
    pField[655] = 0x10;
    pField[656] = 0x00;
    pField[657] = 0x78;
    pField[658] = 0x19;
    pField[659] = 0x19;
    pField[660] = 0xFB;

    pField[661] = 0xF3;
    pField[671] = 0x31;
    pField[672] = 0x31;
    pField[673] = 0x30;
    pField[674] = 0xF0;
    pField[675] = 0xE0;
    pField[676] = 0xE0;

    pField[796] = 0x01;
    pField[797] = 0x01;
    pField[798] = 0x03;
    pField[799] = 0x03;
    pField[800] = 0x03;
    pField[801] = 0x03;
    pField[802] = 0x03;
    pField[803] = 0x01;
    pField[804] = 0x01;

    //over
    pField[284] = 0x7C;
    pField[285] = 0x7E;
    pField[286] = 0x66;
    pField[287] = 0x66;
    pField[288] = 0x7C;
    pField[289] = 0x70;
    pField[290] = 0x7C;
    pField[291] = 0x6E;
    pField[292] = 0x66;

    pField[412] = 0x7E;
    pField[413] = 0x7E;
    pField[414] = 0x60;
    pField[415] = 0x60;
    pField[416] = 0x78;
    pField[417] = 0x78;
    pField[418] = 0x60;
    pField[419] = 0x7F;
    pField[420] = 0x7F;

    pField[540] = 0x06;
    pField[541] = 0x06;
    pField[542] = 0x06;
    pField[543] = 0x8C;
    pField[544] = 0x8C;
    pField[545] = 0xD8;
    pField[546] = 0xD8;
    pField[547] = 0x70;
    pField[548] = 0x70;

    pField[668] = 0xE6;
    pField[669] = 0xE6;
    pField[670] = 0xF6;
    pField[671] = 0x33;
    pField[672] = 0x33;
    pField[673] = 0x31;
    pField[674] = 0xF1;
    pField[675] = 0xE0;
    pField[676] = 0xE0;

    pField[796] = 0x01;
    pField[797] = 0x01;
    pField[798] = 0x03;
    pField[799] = 0x03;
    pField[800] = 0x03;
    pField[801] = 0x03;
    pField[802] = 0x03;
    pField[803] = 0x01;
    pField[804] = 0x01;

    drawField(pField, screen);
    drawScreenBuf(screen);
}

/**
 * NAME: genNewTet
 * PARAMETERS: n/a
 * PURPOSE: to randomly generate a new tetris piece in its first rotation position,
 *  which is indicated by the first array entry Pixel Data for Game Pieces
 * RETURNS: a pointer to an unsigned char, which is indicative of the piece that
 *  is to be randomly generated 
 */

unsigned char* genNewTet() {
    int newTet = rand() % 7;
    switch (newTet) {
        case 0:
            return longPiece[0];
            break;
        case 1:
            return L1Piece[0];
            break;
        case 2:
            return L2Piece[0];
            break;
        case 3:
            return squarePiece[0];
            break;
        case 4:
            return tPiece[0];
            break;
        case 5:
            return sPiece[0];
            break;
        case 6:
            return zPiece[0];
            break;
    }
    return zPiece[0];
}

int main(void) {

    /*
     ***********************************************
     * Setup                                       *
     ***********************************************
     */
    initPIC();
    initLCD();
    clearLCD();


    /*
     ***********************************************
     * Variables                                   *
     ***********************************************
     */
    //Screen buffer and playField
    unsigned char screen[1024];
    unsigned char pField[1024];
    initScreenBuf(screen);
    initPlayField(pField);

    //Current tetris piece
    sprite playPiece;
    playPiece.xPos = 0;
    playPiece.yPos = 2;
    playPiece.rotation = 0;
    playPiece.image = genNewTet();

    //Game Logic Variables
    int ticker = 0;
    int timeForceDown = 20;
    int pi, px, py, fi, fx, fy;
    int blocks, pieceCount = 0;
    int score = 0;
    int gameOver = 0;
    float pointMod = 1.0f;

    //Timer one setup
    //Deprecated, may or may not still be necessary
    PR1 = 10000;
    _T1IF = 0;
    _T1IP = 4;
    _T1IE = 1;
    T1CON = 0x30;

    /*
     ***********************************************
     * Main Game Loop                              *
     ***********************************************
     */
    while (1) {

        while (!gameOver) {

            _TON = 1;
            while (!_T1IF);
            _T1IF = 0;

            /*
             ***********************************************
             * Handle User Input                           *
             ***********************************************
             */
            //Move tetromino left
            if (!_RA0 && collide(playPiece, pField, 0)) {
                playPiece.yPos += 1;
            }
            //Move tetromino right
            if (!_RA1 && collide(playPiece, pField, 1)) {
                playPiece.yPos -= 1;
            }
            //Move tetromino down
            if (!_RA2 && collide(playPiece, pField, 2)) {
                playPiece.xPos += 8;
            }
            //Spin tetromino 
            if (!_RA3 && collide(playPiece, pField, 3)) {
                if (playPiece.rotation == 3) {
                    playPiece.image -= 384;
                } else {
                    playPiece.image += 128;
                }
                playPiece.rotation += playPiece.rotation == 3 ? -3 : 1;

            }

            /*
             ***********************************************
             * Main Game Logic                             *
             ***********************************************
             */
            //Check if its time to force the current piece down
            if (ticker % timeForceDown == 0) {

                //Check if the piece can be forced down 
                if (collide(playPiece, pField, 2)) {

                    //If yes, move it down.
                    playPiece.xPos += 8;

                } else {

                    //If not, lock it into place!
                    for (py = 0; py < 4; py++) {
                        for (px = 0; px < 32; px++) {

                            //Get piece index into the tetromino
                            pi = (py * 32 + px);

                            //Get field index into the play field at the tetromino's location
                            fi = ((playPiece.yPos + py) * 128 + (playPiece.xPos + px));

                            //Check if that block is filled in
                            if (playPiece.image[pi] == 0xff) {

                                //If yes, lock pixel into pField
                                pField[fi] = playPiece.image[pi];
                            }
                        }
                    }


                    //Check for complete lines
                    int movePix = 0;
                    int topFlag = 0;
                    int topMark = 0;

                    for (fx = 0; fx < 120; fx++) {
                        blocks = 0;
                        if (pField[fx] == 0xff) {
                            for (fy = 1; fy < 7; fy++) {
                                if (pField[(fy * 128) + fx] == 0xff) {
                                    blocks++;
                                }
                            }

                        }

                        //If 6 blocks are filled in, line is complete
                        if (blocks == 6) {
                            if (topFlag == 0) {
                                topMark = fx;
                                topFlag = 1;
                            }

                            movePix++;

                            //Delete complete lines
                            for (fy = 1; fy < 7; fy++) {
                                pField[fy * 128 + fx] = 0x00;

                            }
                        }
                    }

                    //moving existing pieces above downwards
                    for (fx = topMark - 1; fx >= 0; fx--) {
                        for (fy = 6; fy > 0; fy--) {
                            pField[(fy * 128) + fx + movePix] = pField[fy * 128 + fx];
                        }

                    }

                    //Allocate points
                    if (movePix == 32) {
                        score += (80 * pointMod);
                    } else {
                        score += movePix + 10*pointMod;
                    }

                    //Every 5 pieces, increase the speed
                    pieceCount++;
                    if (pieceCount % 5 == 0 && timeForceDown > 1) {
                        timeForceDown--;
                        pointMod += 1;
                    }

                    //Once play piece has been locked in, move playPiece back to the 
                    //top middle of screen and generate a new tetromino
                    playPiece.xPos = 0;
                    playPiece.yPos = 3;
                    playPiece.rotation = 0;
                    playPiece.image = genNewTet();

                    //Scan location of new tetromino for any pixels on the game
                    //board. If there are any, oh dear, it's game over!
                    if (!collide(playPiece, pField, 2)) {
                        gameOver = 1;
                    }

                }

            }

            //Increment game ticker
            ticker++;
            
            /*
             ***********************************************
             * Render Output                               *
             ***********************************************
             */
            drawField(pField, screen);
            drawSprite(playPiece, screen);
            drawScreenBuf(screen);
        }//End main game loop


        /*
         ***********************************************
         * Game Over!                                  *
         ***********************************************
         */


        writeScore(score, screen, pField);

        //ToDo: when gameover, display "try again?"
        if (!_RA0) {
            //Reset tetris piece
            playPiece.xPos = 0;
            playPiece.yPos = 3;
            playPiece.rotation = 0;
            playPiece.image = genNewTet();

            //Reset difficulty, score
            pieceCount = 0;
            score = 0;
            timeForceDown = 20;

            //Reset screen buffer and playField
            initScreenBuf(screen);
            initPlayField(pField);

            //Redraw game field, tetris piece, and screen with new data
            drawField(pField, screen);
            drawSprite(playPiece, screen);
            drawScreenBuf(screen);

            //Restart game
            gameOver = false;
        }

    }//Never return
    return 0;
}
